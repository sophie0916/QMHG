results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results1[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results1[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results1[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results1[[line]], type = "l", col = line, ylim = c(0,1))
}
fit <- c(0.5, 0.5, 1)
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results1[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results1[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 100
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results1[[line]], type = "l", col = line, ylim = c(0,1))
}
fit <- c(0.5, 0.5, 1)
N <- 100
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
fit <- c(0.5, 0.5, 1)
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
freqV <- data.frame(getfreq(0.9))
freqV
freqV[1,2] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, 2-1]), N))/tN
freqV
freqV[,2] <- getfreq(freqV[1,2-1])
freqV
fit <- c(0.5, 0.5, 1)
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
freq[,j] <- getfreq(freq[1,j-1])
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
freq[,j] <- getfreq(freq[1,j-1])
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
plot(results[[1,]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
plot(results[1], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
plot(results[[[1]]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
fit <- c(0.5, 0.5, 1)
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
freq[,j] <- getfreq(freq[1,j-1])
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
results[[1]]
N9 <- 1000
tN9 <- N9*2
results9 <- list()
for (i in 1:9) {
freqV9 <- 1/tN9
for (j in 2:200) {
freqV9[j] <- rbinom(n = 1, size = tN9, prob = freqV9[j-1])/tN9
}
results9[[i]] <- freqV9
}
plot(results9[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of A")
for (line in 2:9) {
lines(results9[[line]], type = "l", col = line, ylim = c(0,1))
}
results9[[1]]
getfreq <- function(freqA) {
freqq <- c()
freqq[1] <- freqA
freqq[2] <- 2 * freqA * (1 - freqA)
freqq[3] <- 1 - freqA
return(freqq)
}
probA <- function(fitness, freq, N) {
totalContributedA <- (2 * freq[1] * fitness[1] * N) + (1 * freq[2] * fitness[2] * N)
totalContributedB <- (2 * freq[3] * fitness[3] * N) + (1 * freq[2] * fitness[2] * N)
frequencyContributed <- totalContributedA / (totalContributedA + totalContributedB)
return(frequencyContributed)
}
fit <- c(0.5, 0.5, 1)
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
freq[,j] <- getfreq(freq[1,j-1])
}
results[[i]] <- freqV[1,]
}
results
results[,1]
results[[,1]]
results[1][1]
head(results[1][1])
freq
freqV
fit <- c(0.5, 0.5, 1)
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
freqV[,j] <- getfreq(freqV[1,j-1])
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
freqV
freqV[1]
freqV[,1]
freqV[1,]
fit <- c(0.5, 0.5, 1)
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
freqV[,j] <- getfreq(freqV[1,j-1])
}
results[[i]] <- freqV[1,]
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
freqV
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
freqV
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
freqV <- data.frame(getfreq(0.9))
for (j in 2:200) {
freqV[1,j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[1, j-1]), N))/tN
}
results[[i]] <- freqV[1,]
}
freqV
selection <- function(list, size, AA, Aa, aa){
for(i in 1:200){
P <- sum(list)/size
Q <- (1-P)
fitness <- c(AA, Aa, aa)
contribute <- c()
fr <- c(P^2, 2*P*Q,Q^2)
for(i in 1:3){contribute[i] <- fr[i]*fitness[i]}
sum1 <- sum(contribute)
for (i in 1:3){contribute[i] <- contribute[i]/sum1} #effective f
sum(contribute) #sum of effective f=1
P <- contribute[1]+contribute[2]/2
list2 <- c()
for(i in 1:size){list2[i] <-0}
for (i in 1:round(size*P)){list2[i] <- 1}
list2 <- sample(list2, size, replace=T)
list <- list2
}
return(list2)
}
size <- 10
P <- 0.9
pop <- c(1:(2*size))
for (i in 1:(2*size)){pop[i] <-0}
for (i in 1:(2*size*P)){pop[i]<- 1}
result <- c(1:10)
for (i in 1:10){result[i]=sum(selection(pop, size*2, 0.5, 0.5, 1))/(size*2)}
result
size <- 100
P <- 0.9
pop <- c(1:(2*size))
for (i in 1:(2*size)){pop[i] <-0}
for (i in 1:(2*size*P)){pop[i]<- 1}
result <- c(1:10)
for (i in 1:10){result[i]=sum(selection(pop, size*2, 0.5, 0.5, 1))/(size*2)}
result
results[[1:9]]
results[[1]]
size <- 1000
P <- 0.1
pop <- c(1:(2*size))
for (i in 1:(2*size)){pop[i] <-0}
for (i in 1:(2*size*P)){pop[i]<- 1}
result <- c(1:10)
for (i in 1:10){result[i]=sum(selection(pop, size*2, 0.5, 1, 0.25))/(size*2)}
result
tempfreq <- getfreq(0.9)
tempfreq
freqV <- tempfreq[1]
freqV
fit <- c(0.5, 0.5, 1)
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 1000
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 100
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
getfreq <- function(freqA) {
freqq <- c()
freqq[1] <- freqA
freqq[2] <- 2 * freqA * (1 - freqA)
freqq[3] <- 1 - freqA
return(freqq)
}
probA <- function(fitness, freq, N) {
totalContributedA <- (2 * freq[1] * fitness[1] * N) + (1 * freq[2] * fitness[2] * N)
totalContributedB <- (2 * freq[3] * fitness[3] * N) + (1 * freq[2] * fitness[2] * N)
frequencyContributed <- totalContributedA / (totalContributedA + totalContributedB)
return(frequencyContributed)
}
fit <- c(0.5, 0.5, 1)
N <- 10
tN <- N*2
results <- list()
for (i in 1:9) {
tempfreq <- getfreq(0.9)
freqV <- tempfreq[1]
for (j in 2:200) {
freqV[j-1] <- tempfreq[1]
freqV[j] <- rbinom(n = 1, size = tN, prob = probA(fit, getfreq(freqV[j-1]), N))/tN
tempfreq <- getfreq(freqV[j])
}
results[[i]] <- freqV
}
plot(results[[1]], type = "l", col = 1, ylim = c(0,1), xlab = "Generation", ylab = "Allele Frequency of AAAAA")
for (line in 2:9) {
lines(results[[line]], type = "l", col = line, ylim = c(0,1))
}
render("Assignment07_SophieYeonSooKim.Rmd")
render("Assignment07_SophieYeonSooKim.Rmd")
render("Assignment07_SophieYeonSooKim.Rmd")
